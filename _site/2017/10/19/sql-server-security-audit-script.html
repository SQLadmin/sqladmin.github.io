<!DOCTYPE html><html lang="en" ><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="/assets/css/syntax.css" rel="stylesheet"><title>SQL Server All In One Security Audit Script | The Data Guy</title><meta name="generator" content="Jekyll v4.0.0" /><meta property="og:title" content="SQL Server All In One Security Audit Script" /><meta name="author" content="Bhuvanesh" /><meta property="og:locale" content="en_US" /><meta name="description" content="This audit script will provide you the security loops holes like week passwords, sql service startup type, service account for sql server and etc." /><meta property="og:description" content="This audit script will provide you the security loops holes like week passwords, sql service startup type, service account for sql server and etc." /><meta property="og:site_name" content="The Data Guy" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2017-10-19T16:31:19+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="SQL Server All In One Security Audit Script" /><meta name="twitter:site" content="@bhuvithedataguy" /><meta name="twitter:creator" content="@https://twitter.com/BhuviTheDataGuy" /> <script type="application/ld+json"> {"dateModified":"2017-10-19T16:31:19+00:00","datePublished":"2017-10-19T16:31:19+00:00","url":"/2017/10/19/sql-server-security-audit-script","mainEntityOfPage":{"@type":"WebPage","@id":"/2017/10/19/sql-server-security-audit-script"},"@type":"BlogPosting","author":{"@type":"Person","name":"Bhuvanesh"},"description":"This audit script will provide you the security loops holes like week passwords, sql service startup type, service account for sql server and etc.","headline":"SQL Server All In One Security Audit Script","@context":"https://schema.org"}</script><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}body{font-family:system-ui, sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;line-height:1.7;font-size:1rem;color:#16171a}nav ul{border-right:1px solid #edf2f7}a{color:#000;text-decoration-skip-ink:auto;text-decoration:underline}pre{margin:.5rem 0;padding:.5rem}.post p{margin:.5rem 0}.post h1,.post h2,.post h3,.post h4{margin:1rem 0}.post h2:first-child,.project h2:first-child,.photo h2:first-child{margin-top:0}.meta{margin:2rem 0}code,pre{background:#ecedee}code{padding:.1rem}pre code{border:none}pre{padding:1rem;overflow-x:auto}img{max-width:100%}hr{background:#000;height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem}blockquote{font-style:italic;border-left:5px solid #ececec;padding-left:1rem}h1,h2,h3,h4,h5{line-height:1;margin:1rem 0;font-weight:600}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:0.5rem}.posts ul,header ul{list-style:none}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}main{display:flex;flex-wrap:wrap;max-width:60rem;margin:2rem auto;padding:1rem}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:0.5rem}}section{flex-basis:0;flex-grow:999;min-width:70%;display:flex;flex-direction:column}figcaption{font-size:smaller}#share-bar{font-size:20px}#share-bar h4{margin-bottom:10px;font-weight:500}.share-button{margin:0px;margin-bottom:10px;margin-right:3px;border:1px solid #D3D6D2;padding:5px 10px 5px 10px}.share-button:hover{opacity:1;color:#ffffff}.fa-facebook-official{color:#3b5998}.fa-facebook-official:hover{background-color:#3b5998}.fa-twitter{color:#55acee}.fa-twitter:hover{background-color:#55acee}.fa-google-plus{color:#dd4b39}.fa-google-plus:hover{background-color:#dd4b39}.fa-pinterest-p{color:#cb2027}.fa-pinterest-p:hover{background-color:#cb2027}.fa-tumblr{color:#32506d}.fa-tumblr:hover{background-color:#32506d}.fa-reddit-alien{color:#ff4500}.fa-reddit-alien:hover{background-color:#ff4500}.fa-linkedin{color:#007bb5}.fa-linkedin:hover{background-color:#007bb5}.fa-envelope{color:#444444}.fa-envelope:hover{background-color:#444444}</style></head><body><main role="main"><header role="banner"><h1 class="logo">The Data Guy</h1><div class="page-author h-card p-author"><img src="/assets/circle-cropped.png" class="author-avatar u-photo" alt="Bhuvanesh"></div><nav role="navigation"><ul><li><a href="/" >Home</a></li><li><a href="/posts/" >Posts</a></li><li><a href="/categories/" >Categories</a></li><li><a href="/tags/" >Tags</a></li><li><a href="https://medium.com/@bhuvithedataguy" >Medium Blog</a></li><li><a href="/search" >Search Here</a></li></ul></nav></header><section class="post"><h2>SQL Server All In One Security Audit Script</h2><p><img src="/assets/SQL-Server-All-In-One-Security-Audit-Script.jpeg" alt="All In One Security Audit Script" /></p><p>As a DBA, Secure my SQL server is a pretty important part. Generally Security in the sense most of us point to users and their weak passwords. But apart from user accounts, there are some critical parts are also there.</p><p>Instead of googling it and execute all the queries which are found in many blogs and combine all the reports together is not a feasible way, So I have been taken a list of security checklist and prepared a Tsql script to check all the loopholes in the SQL Server.</p><h3 id="check-list">Check List:</h3><ul><li><strong>SQL Server’s service account: </strong> All SQL server services must be running under an AD account, if it is a workgroup server then it should be an Administrator account.</li><li><strong>Default Directories</strong>: While installing SQL Server it could ask the default directors for Data, Log and Backup. We should not keep this in *C:*</li><li><strong>Services Startup:</strong> SQL services are able to start when the Windows server is started.</li><li><strong>SA Account:</strong> If you don’t want the SA account then go ahead and disabled it. If you need then rename and make a strong password. For disabling SA you can use the below stored procedure. <em>exec sp_SetAutoSAPasswordAndDisable</em></li><li><strong>Password: </strong> Don’t use username and password are same, and never leave it as blank.</li><li><strong>Sysadmin User:</strong> Don’t give sysadmin role to anyone other than DBAs.</li><li><strong>SQL Port:</strong> Its a recommend one to use non default port for SQL server.</li><li><strong>Number of databases:</strong> This is not that much affect the SQL servers security, but use less then 100 databases for a medium size server.</li><li><strong>Buildin\Administrator:</strong> In SQL server BUILDIN\Administrator login is enabled then go and immediately disable it. Because who all are have administrator privilege in windows server, those users can directly access the SQL server.</li><li><strong>Database Level Access:</strong> limit the <em>db_owner</em> and <em>db_writter</em> access.</li></ul><p><strong>Download the Script:</strong> <a href="https://github.com/SqlAdmin/tsqltools/blob/master/Security%20Audit/tsqltools_AllInOneSecurityAudit.sql">Get it from my Git repo</a></p><h3 id="results">Results:</h3><p>Server Level Audit</p><p><img src="/assets/All-In-One-Security-Audit-Script1.png" alt="All In One Security Audit Script1" /></p><p>Database level Audit</p><p><img src="/assets/All-In-One-Security-Audit-Script2.png" alt="All In One Security Audit Script" /></p><span class="meta"><time datetime="2017-10-19T16:31:19+00:00">October 19, 2017</time> &middot; <a href="/tags/#security">security</a>, <a href="/tags/#sqlserver">sqlserver</a>, <a href="/tags/#tsql">tsql</a></span><hr> <!--<span class="meta"><time datetime="2017-10-19T16:31:19+00:00">October 19, 2017</time> &middot; <a class="post" href="/tag/security">security</a>, <a class="post" href="/tag/sqlserver">sqlserver</a>, <a class="post" href="/tag/tsql">tsql</a></span> --></section></main></body></html>
