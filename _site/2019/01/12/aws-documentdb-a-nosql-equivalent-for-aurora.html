<!DOCTYPE html><html lang="en" ><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="/assets/css/syntax.css" rel="stylesheet"><title>AWS DocumentDB - A NoSQL Equivalent For Aurora | The Data Guy</title><meta name="generator" content="Jekyll v4.0.0" /><meta property="og:title" content="AWS DocumentDB - A NoSQL Equivalent For Aurora" /><meta name="author" content="Bhuvanesh" /><meta property="og:locale" content="en_US" /><meta name="description" content="AWS announced managed mongoDB as AWS DocumentDB. Here we’ll se how this is equivalent to aurora and what is feature and future expectations." /><meta property="og:description" content="AWS announced managed mongoDB as AWS DocumentDB. Here we’ll se how this is equivalent to aurora and what is feature and future expectations." /><meta property="og:site_name" content="The Data Guy" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-01-12T13:57:12+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="AWS DocumentDB - A NoSQL Equivalent For Aurora" /><meta name="twitter:site" content="@bhuvithedataguy" /><meta name="twitter:creator" content="@https://twitter.com/BhuviTheDataGuy" /> <script type="application/ld+json"> {"dateModified":"2019-01-12T13:57:12+00:00","datePublished":"2019-01-12T13:57:12+00:00","url":"/2019/01/12/aws-documentdb-a-nosql-equivalent-for-aurora","mainEntityOfPage":{"@type":"WebPage","@id":"/2019/01/12/aws-documentdb-a-nosql-equivalent-for-aurora"},"@type":"BlogPosting","author":{"@type":"Person","name":"Bhuvanesh"},"description":"AWS announced managed mongoDB as AWS DocumentDB. Here we’ll se how this is equivalent to aurora and what is feature and future expectations.","headline":"AWS DocumentDB - A NoSQL Equivalent For Aurora","@context":"https://schema.org"}</script><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}body{font-family:system-ui, sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;line-height:1.7;font-size:1rem;color:#16171a}nav ul{border-right:1px solid #edf2f7}a{color:#000;text-decoration-skip-ink:auto;text-decoration:underline}pre{margin:.5rem 0;padding:.5rem}.post p{margin:.5rem 0}.post h1,.post h2,.post h3,.post h4{margin:1rem 0}.post h2:first-child,.project h2:first-child,.photo h2:first-child{margin-top:0}.meta{margin:2rem 0}code,pre{background:#ecedee}code{padding:.1rem}pre code{border:none}pre{padding:1rem;overflow-x:auto}img{max-width:100%}hr{background:#000;height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem}blockquote{font-style:italic;border-left:5px solid #ececec;padding-left:1rem}h1,h2,h3,h4,h5{line-height:1;margin:1rem 0;font-weight:600}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:0.5rem}.posts ul,header ul{list-style:none}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}main{display:flex;flex-wrap:wrap;max-width:60rem;margin:2rem auto;padding:1rem}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:0.5rem}}section{flex-basis:0;flex-grow:999;min-width:70%;display:flex;flex-direction:column}figcaption{font-size:smaller}#share-bar{font-size:20px}#share-bar h4{margin-bottom:10px;font-weight:500}.share-button{margin:0px;margin-bottom:10px;margin-right:3px;border:1px solid #D3D6D2;padding:5px 10px 5px 10px}.share-button:hover{opacity:1;color:#ffffff}.fa-facebook-official{color:#3b5998}.fa-facebook-official:hover{background-color:#3b5998}.fa-twitter{color:#55acee}.fa-twitter:hover{background-color:#55acee}.fa-google-plus{color:#dd4b39}.fa-google-plus:hover{background-color:#dd4b39}.fa-pinterest-p{color:#cb2027}.fa-pinterest-p:hover{background-color:#cb2027}.fa-tumblr{color:#32506d}.fa-tumblr:hover{background-color:#32506d}.fa-reddit-alien{color:#ff4500}.fa-reddit-alien:hover{background-color:#ff4500}.fa-linkedin{color:#007bb5}.fa-linkedin:hover{background-color:#007bb5}.fa-envelope{color:#444444}.fa-envelope:hover{background-color:#444444}</style></head><body><main role="main"><header role="banner"><h1 class="logo">The Data Guy</h1><div class="page-author h-card p-author"><img src="/assets/circle-cropped.png" class="author-avatar u-photo" alt="Bhuvanesh"></div><nav role="navigation"><ul><li><a href="/" >Home</a></li><li><a href="/posts/" >Posts</a></li><li><a href="/categories/" >Categories</a></li><li><a href="/tags/" >Tags</a></li><li><a href="https://medium.com/@bhuvithedataguy" >Medium Blog</a></li><li><a href="/search" >Search Here</a></li></ul></nav></header><section class="post"><h2>AWS DocumentDB - A NoSQL Equivalent For Aurora</h2><p><img src="/assets/AWS-DocumentDB.jpg" alt="AWS DocumentDB" /></p><p>As we all know that AWS announced the managed MongoDB services called as AWS DocumentDB. MongoDB is one of my favourite NoSQL Databases even for developers. Since Im working with MongoDB in AWS, its the very first step setting up the replica set and shards. It’ll take a couple of mins to configure. But setting up the monitoring and other stuffs like troubleshooting replication issue, resync the failed replica and fixing issues in sharding is a big headache for DBAs. I guess even AWS felt the pain :)</p><p>Now we have the managed mongo clusters in AWS. The reason why Im writing this blog is, Im a very big fan of AWS Aurora. The designing concept is awesome. After aurora’s arrival, most of the MySQL workloads became very smooth and later PostgreSQL.</p><h2 id="what-aws-document-db-does">What AWS Document DB does?</h2><ul><li>MongoDB Compatible with 3.6.</li><li>Fully managed.</li><li>Works only inside the VPC.</li><li>For public access we can use SSL tunneling from an EC2 instance or port farwarding.</li><li>Upto 15 replicas.</li><li>In-build load balancer for read workloads(reader endpoint).</li><li>Priority based failover (assign which node to be failed over first).</li><li>No need to for pre-provisioning the storage upfront.</li><li>Scaleable storage upto 64TB. (automatically adds 10GB whenever it reaches the threshold)</li><li>Automated snapshots upto 35days.</li><li>Read Isolation - Kind of read committed mechanism for reader nodes.</li><li>All mongoDB read preferences are supported. ( primary, primaryPreferred, secondary, secondaryPreferred, nearest).</li></ul><h2 id="replication">Replication:</h2><p>While reading the above points, you may realize that, all of the features are very similar to Aurora. Yes, exactly it matches Aurora’s architecture. AWS DocumentDB is not using native mongodb replication mechanism. To understand its replication, let rewind how Aurora is handling the replication.</p><p>Aurora is using a clustered volumes which has 2 volumes in each availability zone and span across 3 zones. So totally 6 volumes are in that cluster. While writing something on the Clustered volume, it’ll write to all 6 volumes in parallel. Also its PIOPS volumes. From my previous experience aurora handled 40000 Write IOPS.</p><p><img src="/assets/AWS-DocumentDB1-1024x537.jpg" alt="AWS DocumentDB" /></p><p>Now in DocumentDB its almost similar to Aurora’s write operation. Here it’ll use the replica set for maintaining the quorum and all but for data replication, instead of replicating the data its just replicate the state of the write to each replica. So there is no much write ops and it’ll improve the replication performance. AWS claims that usually it the lag is less than 100ms latency to replicate the state.</p><h2 id="cool-features-in-aws-doumentdb">Cool features in AWS DoumentDB:</h2><h3 id="cache-warming">Cache Warming:</h3><p>During the failover, AWS DocumentDB cache the frequetnly access data pages in memory. So after the failover still it holds the cache in Cache layer. So the new primary will not do Disk Reads even after failover.</p><h3 id="crash-recovery">Crash Recovery:</h3><p>If you mongo instance crashed and AWS tries to recover using asynchronous parallel threads. So the instance will be up as soon as possible.</p><h3 id="read-isolation">Read Isolation:</h3><p>If you are familiar with Relational databases transaction isolation, then it’s almost same. While reading the data from reader instance, it’ll return the previously committed data.</p><h2 id="then-how-about-sharding">Then how about sharding?</h2><p><strong>You may come with this question, can we have shards in AWS DoucmentDB?</strong></p><p>To answer this think about where we need the sharding. If we have massive write Ops from different geo locations, then sharding might help you to reduce your write latency and replication lag. But here its a clustered volume and also all the writes are performed in parallel on a PIOPS volumes. So according to me sharding is not necessary here. But to reduce latency in different geo locations then this statement is not correct.</p><h2 id="what-im-expecting-from-aws-for-documentdb">What Im expecting from AWS for DocumentDB?</h2><ul><li>Global database - Aurora has globally distributed database service which is equivalent for Sharding.</li><li>Version 4.0 or support for ACID - 4.0 has ACID compliance. But SSPL licensing an issue.</li><li>Newer versions - Again refer the above point.</li><li>Add external replica from EC2.</li></ul><h2 id="external-resources">External Resources:</h2><ul><li>Limitations - <a href="https://docs.aws.amazon.com/documentdb/latest/developerguide/limits.html">https://docs.aws.amazon.com/documentdb/latest/developerguide/limits.html</a></li><li>How its works - <a href="https://docs.aws.amazon.com/documentdb/latest/developerguide/how-it-works.html">https://docs.aws.amazon.com/documentdb/latest/developerguide/how-it-works.html</a></li><li>Create the cluster - <a href="https://aws.amazon.com/blogs/aws/new-amazon-documentdb-with-mongodb-compatibility-fast-scalable-and-highly-available/">https://aws.amazon.com/blogs/aws/new-amazon-documentdb-with-mongodb-compatibility-fast-scalable-and-highly-available/</a></li><li>Aurora’s storage internal - <a href="https://aws.amazon.com/blogs/database/introducing-the-aurora-storage-engine/">https://aws.amazon.com/blogs/database/introducing-the-aurora-storage-engine/</a></li></ul><span class="meta"><time datetime="2019-01-12T13:57:12+00:00">January 12, 2019</time> &middot; <a href="/tags/#aurora">aurora</a>, <a href="/tags/#aws">aws</a>, <a href="/tags/#documentdb">documentdb</a>, <a href="/tags/#mongodb">mongodb</a>, <a href="/tags/#nosql">nosql</a></span><hr> <!--<span class="meta"><time datetime="2019-01-12T13:57:12+00:00">January 12, 2019</time> &middot; <a class="post" href="/tag/aurora">aurora</a>, <a class="post" href="/tag/aws">aws</a>, <a class="post" href="/tag/documentdb">documentdb</a>, <a class="post" href="/tag/mongodb">mongodb</a>, <a class="post" href="/tag/nosql">nosql</a></span> --></section></main></body></html>
