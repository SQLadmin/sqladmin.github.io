<!DOCTYPE html><html lang="en" ><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="/assets/css/syntax.css" rel="stylesheet"><title>RunDeck Series 2 - Add Nodes to the Rundeck | The Data Guy</title><meta name="generator" content="Jekyll v4.0.0" /><meta property="og:title" content="RunDeck Series 2 - Add Nodes to the Rundeck" /><meta name="author" content="Bhuvanesh" /><meta property="og:locale" content="en_US" /><meta name="description" content="Add nodes to rundeck 3.0+ using resources.xml. Also we can import exsiting project nodes to another project. We have 3 ways to add nodes." /><meta property="og:description" content="Add nodes to rundeck 3.0+ using resources.xml. Also we can import exsiting project nodes to another project. We have 3 ways to add nodes." /><meta property="og:site_name" content="The Data Guy" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-12-28T19:57:17+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="RunDeck Series 2 - Add Nodes to the Rundeck" /><meta name="twitter:site" content="@bhuvithedataguy" /><meta name="twitter:creator" content="@https://twitter.com/BhuviTheDataGuy" /> <script type="application/ld+json"> {"dateModified":"2018-12-28T19:57:17+00:00","datePublished":"2018-12-28T19:57:17+00:00","url":"/2018/12/28/add-nodes-to-the-rundeck","mainEntityOfPage":{"@type":"WebPage","@id":"/2018/12/28/add-nodes-to-the-rundeck"},"@type":"BlogPosting","author":{"@type":"Person","name":"Bhuvanesh"},"description":"Add nodes to rundeck 3.0+ using resources.xml. Also we can import exsiting project nodes to another project. We have 3 ways to add nodes.","headline":"RunDeck Series 2 - Add Nodes to the Rundeck","@context":"https://schema.org"}</script><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}body{font-family:system-ui, sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;line-height:1.7;font-size:1rem;color:#16171a}nav ul{border-right:1px solid #edf2f7}a{color:#000;text-decoration-skip-ink:auto;text-decoration:underline}pre{margin:.5rem 0;padding:.5rem}.post p{margin:.5rem 0}.post h1,.post h2,.post h3,.post h4{margin:1rem 0}.post h2:first-child,.project h2:first-child,.photo h2:first-child{margin-top:0}.meta{margin:2rem 0}code,pre{background:#ecedee}code{padding:.1rem}pre code{border:none}pre{padding:1rem;overflow-x:auto}img{max-width:100%}hr{background:#000;height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem}blockquote{font-style:italic;border-left:5px solid #ececec;padding-left:1rem}h1,h2,h3,h4,h5{line-height:1;margin:1rem 0;font-weight:600}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:0.5rem}.posts ul,header ul{list-style:none}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}main{display:flex;flex-wrap:wrap;max-width:60rem;margin:2rem auto;padding:1rem}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:0.5rem}}section{flex-basis:0;flex-grow:999;min-width:70%;display:flex;flex-direction:column}figcaption{font-size:smaller}#share-bar{font-size:20px}#share-bar h4{margin-bottom:10px;font-weight:500}.share-button{margin:0px;margin-bottom:10px;margin-right:3px;border:1px solid #D3D6D2;padding:5px 10px 5px 10px}.share-button:hover{opacity:1;color:#ffffff}.fa-facebook-official{color:#3b5998}.fa-facebook-official:hover{background-color:#3b5998}.fa-twitter{color:#55acee}.fa-twitter:hover{background-color:#55acee}.fa-google-plus{color:#dd4b39}.fa-google-plus:hover{background-color:#dd4b39}.fa-pinterest-p{color:#cb2027}.fa-pinterest-p:hover{background-color:#cb2027}.fa-tumblr{color:#32506d}.fa-tumblr:hover{background-color:#32506d}.fa-reddit-alien{color:#ff4500}.fa-reddit-alien:hover{background-color:#ff4500}.fa-linkedin{color:#007bb5}.fa-linkedin:hover{background-color:#007bb5}.fa-envelope{color:#444444}.fa-envelope:hover{background-color:#444444}</style></head><body><main role="main"><header role="banner"><h1 class="logo">The Data Guy</h1><div class="page-author h-card p-author"><img src="/assets/circle-cropped.png" class="author-avatar u-photo" alt="Bhuvanesh"></div><nav role="navigation"><ul><li><a href="/" >Home</a></li><li><a href="/posts/" >Posts</a></li><li><a href="/categories/" >Categories</a></li><li><a href="/tags/" >Tags</a></li><li><a href="https://medium.com/@bhuvithedataguy" >Medium Blog</a></li><li><a href="/search" >Search Here</a></li></ul></nav></header><section class="post"><h2>RunDeck Series 2 - Add Nodes to the Rundeck</h2><p>Add nodes to the Rundeck Server is very next step after installation. Here we are going to see adding Linux nodes to Rundeck. After Rudeck 3.0+ the resources.xml file will not create automatically. In previous versions, this file was automatically created while creating a project. We’ll node nodes details in this file. But in latest versions, it’s not creating automatically.</p><h2 id="option1-creating-resourcesxml-manually">Option#1 Creating resources.xml manually</h2><p>In this approach, we’ll add all the nodes in a file called resources.xml. Once you created a project follow the below steps.<br /> <strong>Job Name: Test-Job</strong><br /> Add the below lines in <code class="language-html highlighter-rouge">project.properties</code> file.</p><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="c">#Replace Test-Job with your job name</span>

resources.source.1.config.file<span class="o">=</span>/var/rundeck/projects/Test-Job/etc/resources.xml
resources.source.1.config.generateFileAutomatically<span class="o">=</span><span class="nb">true
</span>resources.source.1.config.includeServerNode<span class="o">=</span><span class="nb">true
</span>resources.source.1.type<span class="o">=</span>file</code></pre></figure><h3 id="create-the-resourcesxml-file">Create the resources.xml file</h3><figure class="highlight">><code class="language-html" data-lang="html"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre> cd /var/rundeck/projects/Test-Job/etc/
    touch resouces.xml
    vi resources.xml

    <span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
    <span class="nt">&lt;project&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">"mysql-master"</span>  <span class="na">tags=</span><span class="s">"mysql"</span> <span class="na">hostname=</span><span class="s">"10.0.0.1"</span> <span class="na">osArch=</span><span class="s">"amd64"</span> <span class="na">osFamily=</span><span class="s">"unix"</span> <span class="na">osName=</span><span class="s">"Linux"</span> <span class="na">osVersion=</span><span class="s">"4.9.0-2-amd64"</span> <span class="na">username=</span><span class="s">"rundeck"</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">"replica-01"</span>  <span class="na">tags=</span><span class="s">"mysql"</span> <span class="na">hostname=</span><span class="s">"10.0.0.2"</span> <span class="na">osArch=</span><span class="s">"amd64"</span> <span class="na">osFamily=</span><span class="s">"unix"</span> <span class="na">osName=</span><span class="s">"Linux"</span> <span class="na">osVersion=</span><span class="s">"4.9.0-2-amd64"</span> <span class="na">username=</span><span class="s">"rundeck"</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;/project&gt;</span>
 
</pre></figure><p>Save this file and restart Rundeck service.</p><figure class="highlight"><pre><code class="language-shell" data-lang="shell">service rundeckd restart</code></pre></figure><h2 id="option2-import-from-other-projects">Option#2 Import from other projects</h2><p>We need to add nodes whenever we create a new project. From the above example, we added nodes to Test-Job project. If we create one more project again we need to follow the same steps. Instead, we can export the nodes from any existing projects.<br /> <strong>Project Name:</strong> <strong>sqladmin-jobs</strong><br /> Go to Projects –&gt; sqladmin-jobs.<br /> Project Settings –&gt; Edit Nodes –&gt; Configure Nodes.<br /> Add Sources –&gt; File.</p><p><img src="/assets/Add-Nodes-to-the-Rundeck-1024x546.jpg" alt="Add Nodes to the Rundeck" /> <img src="/assets/Add-Nodes-to-the-Rundeck1.jpg" alt="Add Nodes to the Rundeck" /> <img src="/assets/Add-Nodes-to-the-Rundeck2-1024x313.jpg" alt="Add Nodes to the Rundeck" /></p><ul><li>Format: resourcesxml</li><li>File Path: /var/rundeck/projects/Test-Job/etc/resources.xml</li><li>Generate: Yes</li></ul><p><img src="/assets/Add-Nodes-to-the-Rundeck3-1024x336.jpg" alt="Add Nodes to the Rundeck" /></p><p>Save it.<br /> Go to nodes and you can see the nodes.</p><p><img src="/assets/Add-Nodes-to-the-Rundeck4.jpg" alt="Add Nodes to the Rundeck" /></p><h2 id="option3-import-from-directory">Option#3 Import from Directory</h2><p>This is similar to the previous step. But here we’ll give the existing project’s resources.xml file’s directory. It’ll automatically scan and the directory and import the nodes.<br /> Go to Project Settings –&gt; Edit Nodes –&gt; Configure nodes –&gt; Add Source.<br /> Select Directory.</p><p><img src="/assets/Add-Nodes-to-the-Rundeck5.jpg" alt="Add Nodes to the Rundeck" /></p><h2 id="create-login-for-rundeck-on-nodes">Create Login for Rundeck on Nodes</h2><p>Now your nodes are added, But still, Rundeck will not control anything on these nodes. Because we need to create a user for Rundeck to login via SSH. By defaultrundeck user has SSH key (both public and private) in its home directory <code class="language-html highlighter-rouge">(/var/lib/rundeck/.ssh/id_rsa)</code>. So copy the id_rsa.pub contents to other nodes.</p><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">cat</span> /var/lib/rundeck/.ssh/id_rsa.pub  

ssh-rsa AAAAB3NzaC1yc2EAAAADAQABxxxxxxxxxxxWZVfPZ53GtpnlSact83ZTX7+FL7KkgPvJzUhkiGIwxxthOZMXrO3pBaON7OCbhwv4QxkrfphBtJe2jHPbJbc1TLw803</code></pre></figure><p>Login to your nodes and run the following commands. This will create an user called rundeck and copy the id_rsa.pub as SSH key. Also make this user as a sudo user.</p><p><strong>For CentOS:</strong></p><figure class="highlight"><pre><code class="language-shell" data-lang="shell">adduser rundeck    
<span class="nb">mkdir</span> <span class="nt">-p</span> /home/rundeck/.ssh  

<span class="c"># Replace the "ssh-rsa ...." with your id_rsa.pub  </span>
<span class="nb">echo</span> <span class="s2">"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABxxxxxxxxxxxxxWZVfPZ53GtpnlSact83ZTX7+FL7KkgPvJzUhkiGIwxxthOZMXrO3pBaON7OCbhwv4QxkrfphBtJe2jHPbJbc1TLw803"</span> <span class="o">&gt;&gt;</span>  /home/rundeck/.ssh/authorized_keys  
<span class="nb">chown </span>rundeck:rundeck /home/rundeck/  
<span class="nb">echo</span> <span class="s2">"rundeck ALL=(ALL)  NOPASSWD: ALL"</span> <span class="o">&gt;&gt;</span> /etc/sudoers</code></pre></figure><p><strong>For Ubuntu:</strong></p><figure class="highlight"><pre><code class="language-shell" data-lang="shell">adduser rundeck  <span class="nt">--disabled-password</span>  
<span class="nb">mkdir</span> <span class="nt">-p</span> /home/rundeck/.ssh  

<span class="c"># Replace the "ssh-rsa ...." with your id_rsa.pub  </span>
<span class="nb">echo</span> <span class="s2">"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABxxxxxxxxxxWZVfPZ53GtpnlSact83ZTX7+FL7KkgPvJzUhkiGIwxxthOZMXrO3pBaON7OCbhwv4QxkrfphBtJe2jHPbJbc1TLw803"</span> <span class="o">&gt;&gt;</span>  /home/rundeck/.ssh/authorized_keys  
<span class="nb">chown </span>rundeck:rundeck /home/rundeck/  
<span class="nb">echo</span> <span class="s2">"rundeck ALL=(ALL)  NOPASSWD: ALL"</span> <span class="o">&gt;&gt;</span> /etc/sudoers</code></pre></figure><span class="meta"><time datetime="2018-12-28T19:57:17+00:00">December 28, 2018</time> &middot; <a href="/tags/#automation">automation</a>, <a href="/tags/#rundeck">rundeck</a>, <a href="/tags/#rundeck series">rundeck series</a></span><hr> <!--<span class="meta"><time datetime="2018-12-28T19:57:17+00:00">December 28, 2018</time> &middot; <a class="post" href="/tag/automation">automation</a>, <a class="post" href="/tag/rundeck">rundeck</a>, <a class="post" href="/tag/rundeck series">rundeck series</a></span> --></section></main></body></html>
